{"version":3,"file":"use-focus-trap.esm.7c167385.js","sources":["../../../node_modules/@headlessui/react/dist/hooks/use-is-mounted.esm.js","../../../node_modules/@headlessui/react/dist/hooks/use-focus-trap.esm.js"],"sourcesContent":["import { useRef, useEffect } from 'react';\n\nfunction useIsMounted() {\n  var mounted = useRef(false);\n  useEffect(function () {\n    mounted.current = true;\n    return function () {\n      mounted.current = false;\n    };\n  }, []);\n  return mounted;\n}\n\nexport { useIsMounted };\n//# sourceMappingURL=use-is-mounted.esm.js.map\n","import { createForOfIteratorHelperLoose as _createForOfIteratorHelperLoose } from '../_virtual/_rollupPluginBabelHelpers.js';\nimport { useRef, useEffect } from 'react';\nimport { Keys } from '../components/keyboard.esm.js';\nimport { focusElement, focusIn, Focus, FocusResult } from '../utils/focus-management.esm.js';\nimport { useWindowEvent } from './use-window-event.esm.js';\nimport { useIsMounted } from './use-is-mounted.esm.js';\n\nvar Features;\n\n(function (Features) {\n  /** No features enabled for the `useFocusTrap` hook. */\n  Features[Features[\"None\"] = 1] = \"None\";\n  /** Ensure that we move focus initially into the container. */\n\n  Features[Features[\"InitialFocus\"] = 2] = \"InitialFocus\";\n  /** Ensure that pressing `Tab` and `Shift+Tab` is trapped within the container. */\n\n  Features[Features[\"TabLock\"] = 4] = \"TabLock\";\n  /** Ensure that programmatically moving focus outside of the container is disallowed. */\n\n  Features[Features[\"FocusLock\"] = 8] = \"FocusLock\";\n  /** Ensure that we restore the focus when unmounting the component that uses this `useFocusTrap` hook. */\n\n  Features[Features[\"RestoreFocus\"] = 16] = \"RestoreFocus\";\n  /** Enable all features. */\n\n  Features[Features[\"All\"] = 30] = \"All\";\n})(Features || (Features = {}));\n\nfunction useFocusTrap(container, features, _temp) {\n  if (features === void 0) {\n    features = Features.All;\n  }\n\n  var _ref = _temp === void 0 ? {} : _temp,\n      initialFocus = _ref.initialFocus,\n      containers = _ref.containers;\n\n  var restoreElement = useRef(typeof window !== 'undefined' ? document.activeElement : null);\n  var previousActiveElement = useRef(null);\n  var mounted = useIsMounted();\n  var featuresRestoreFocus = Boolean(features & Features.RestoreFocus);\n  var featuresInitialFocus = Boolean(features & Features.InitialFocus); // Capture the currently focused element, before we enable the focus trap.\n\n  useEffect(function () {\n    if (!featuresRestoreFocus) return;\n    restoreElement.current = document.activeElement;\n  }, [featuresRestoreFocus]); // Restore the focus when we unmount the component.\n\n  useEffect(function () {\n    if (!featuresRestoreFocus) return;\n    return function () {\n      focusElement(restoreElement.current);\n      restoreElement.current = null;\n    };\n  }, [featuresRestoreFocus]); // Handle initial focus\n\n  useEffect(function () {\n    if (!featuresInitialFocus) return;\n    if (!container.current) return;\n    var activeElement = document.activeElement;\n\n    if (initialFocus == null ? void 0 : initialFocus.current) {\n      if ((initialFocus == null ? void 0 : initialFocus.current) === activeElement) {\n        previousActiveElement.current = activeElement;\n        return; // Initial focus ref is already the active element\n      }\n    } else if (container.current.contains(activeElement)) {\n      previousActiveElement.current = activeElement;\n      return; // Already focused within Dialog\n    } // Try to focus the initialFocus ref\n\n\n    if (initialFocus == null ? void 0 : initialFocus.current) {\n      focusElement(initialFocus.current);\n    } else {\n      if (focusIn(container.current, Focus.First) === FocusResult.Error) {\n        console.warn('There are no focusable elements inside the <FocusTrap />');\n      }\n    }\n\n    previousActiveElement.current = document.activeElement;\n  }, [container, initialFocus, featuresInitialFocus]); // Handle `Tab` & `Shift+Tab` keyboard events\n\n  useWindowEvent('keydown', function (event) {\n    if (!(features & Features.TabLock)) return;\n    if (!container.current) return;\n    if (event.key !== Keys.Tab) return;\n    event.preventDefault();\n\n    if (focusIn(container.current, (event.shiftKey ? Focus.Previous : Focus.Next) | Focus.WrapAround) === FocusResult.Success) {\n      previousActiveElement.current = document.activeElement;\n    }\n  }); // Prevent programmatically escaping the container\n\n  useWindowEvent('focus', function (event) {\n    if (!(features & Features.FocusLock)) return;\n    var allContainers = new Set(containers == null ? void 0 : containers.current);\n    allContainers.add(container);\n    if (!allContainers.size) return;\n    var previous = previousActiveElement.current;\n    if (!previous) return;\n    if (!mounted.current) return;\n    var toElement = event.target;\n\n    if (toElement && toElement instanceof HTMLElement) {\n      if (!contains(allContainers, toElement)) {\n        event.preventDefault();\n        event.stopPropagation();\n        focusElement(previous);\n      } else {\n        previousActiveElement.current = toElement;\n        focusElement(toElement);\n      }\n    } else {\n      focusElement(previousActiveElement.current);\n    }\n  }, true);\n}\n\nfunction contains(containers, element) {\n  for (var _iterator = _createForOfIteratorHelperLoose(containers), _step; !(_step = _iterator()).done;) {\n    var _container$current;\n\n    var container = _step.value;\n    if ((_container$current = container.current) == null ? void 0 : _container$current.contains(element)) return true;\n  }\n\n  return false;\n}\n\nexport { Features, useFocusTrap };\n//# sourceMappingURL=use-focus-trap.esm.js.map\n"],"names":["useRef","useEffect"],"mappings":"2HAEA,YAAwB,CACtB,GAAI,GAAUA,iBAAO,IACrBC,2BAAU,UAAY,CACpB,SAAQ,QAAU,GACX,UAAY,CACjB,EAAQ,QAAU,KAEnB,IACI,ECHN,GAAC,GAEJ,AAAC,UAAU,EAAU,CAEnB,EAAS,EAAS,KAAU,GAAK,OAGjC,EAAS,EAAS,aAAkB,GAAK,eAGzC,EAAS,EAAS,QAAa,GAAK,UAGpC,EAAS,EAAS,UAAe,GAAK,YAGtC,EAAS,EAAS,aAAkB,IAAM,eAG1C,EAAS,EAAS,IAAS,IAAM,QAChC,GAAa,GAAW,KAE3B,WAAsB,EAAW,EAAU,EAAO,CAChD,AAAI,IAAa,QACf,GAAW,EAAS,KAGtB,GAAI,GAAO,IAAU,OAAS,GAAK,EAC/B,EAAe,EAAK,aACpB,EAAa,EAAK,WAElB,EAAiBD,iBAAO,MAAO,SAAW,YAAc,SAAS,cAAgB,MACjF,EAAwBA,iBAAO,MAC/B,EAAU,IACV,EAAuB,QAAQ,EAAW,EAAS,cACnD,EAAuB,QAAQ,EAAW,EAAS,cAEvDC,oBAAU,UAAY,CACpB,AAAI,CAAC,GACL,GAAe,QAAU,SAAS,gBACjC,CAAC,IAEJA,oBAAU,UAAY,CACpB,GAAI,EAAC,EACL,MAAO,WAAY,CACjB,EAAa,EAAe,SAC5B,EAAe,QAAU,OAE1B,CAAC,IAEJA,oBAAU,UAAY,CACpB,GAAI,EAAC,GACD,EAAC,EAAU,QACf,IAAI,GAAgB,SAAS,cAE7B,GAAI,GAAgB,KAAO,OAAS,EAAa,SAC/C,GAAK,IAAgB,KAAO,OAAS,EAAa,WAAa,EAAe,CAC5E,EAAsB,QAAU,EAChC,gBAEO,EAAU,QAAQ,SAAS,GAAgB,CACpD,EAAsB,QAAU,EAChC,OAIF,AAAI,IAAgB,KAAO,OAAS,EAAa,SAC/C,EAAa,EAAa,SAEtB,EAAQ,EAAU,QAAS,EAAM,SAAW,EAAY,OAC1D,QAAQ,KAAK,4DAIjB,EAAsB,QAAU,SAAS,gBACxC,CAAC,EAAW,EAAc,IAE7B,EAAe,UAAW,SAAU,EAAO,CACzC,AAAI,CAAE,GAAW,EAAS,UACtB,CAAC,EAAU,SACX,EAAM,MAAQ,EAAK,KACvB,GAAM,iBAEF,EAAQ,EAAU,QAAU,GAAM,SAAW,EAAM,SAAW,EAAM,MAAQ,EAAM,cAAgB,EAAY,SAChH,GAAsB,QAAU,SAAS,kBAI7C,EAAe,QAAS,SAAU,EAAO,CACvC,GAAI,EAAE,GAAW,EAAS,WAC1B,IAAI,GAAgB,GAAI,KAAI,GAAc,KAAO,OAAS,EAAW,SAErE,GADA,EAAc,IAAI,GACd,EAAC,EAAc,KACnB,IAAI,GAAW,EAAsB,QACrC,GAAI,EAAC,GACD,EAAC,EAAQ,QACb,IAAI,GAAY,EAAM,OAEtB,AAAI,GAAa,YAAqB,aACpC,AAAK,EAAS,EAAe,GAK3B,GAAsB,QAAU,EAChC,EAAa,IALb,GAAM,iBACN,EAAM,kBACN,EAAa,IAMf,EAAa,EAAsB,aAEpC,IAGL,WAAkB,EAAY,EAAS,CACrC,OAAS,GAAY,EAAgC,GAAa,EAAO,CAAE,GAAQ,KAAa,MAAO,CACrG,GAAI,GAEA,EAAY,EAAM,MACtB,GAAK,GAAqB,EAAU,UAAY,KAAO,OAAS,EAAmB,SAAS,GAAU,MAAO,GAG/G,MAAO"}